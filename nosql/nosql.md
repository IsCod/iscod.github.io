# NoSQL

`NoSQL`数据库（意即"不仅仅是SQL"）既并非表格格式，其存储数据的方式与关系表不同。
`NoSQL`数据库的类型因数据模型而异。主要类型包括文档、键值、宽列和图形。它们提供了灵活的模式，可以随大量数据和高用户负载而轻松扩展。

> [出于正确的原因选择nosql](https://blog.fatalmind.com/2011/05/13/choosing-nosql-for-the-right-reason/index.html)

## NoSQL 是什么？

人们使用`NoSQL`数据库一词时，通常会使用它来指代任何非关系型数据库。有人说`NoSQL`代表`非SQL`，而另一些人则说`不仅仅是SQL`。
无论哪种方式，大多数人都认为`NoSQL`数据库是以关系表以外的格式存储数据的数据库。

## NoSQL 数据库有哪些类型？

NoSQL目前主要有四种类型: `文档数据库`、`键值数据库`、`宽列存储数据库`、`图形数据库`


## 文档数据库

文档数据库将数据存储在类似于`JSON`（JavaScript 对象表示法）对象的文档中。

每个文档包含成对的字段和值。这些值通常可以是各种类型, 包括字符串、数字、布尔值、数组或对象等, 并且它们的结构通常与开发者在代码中使用的对象保持一致。
由于字段值类型的多样性和强大的查询语言能力, 文档数据库非常适合各种各样的使用案例, 并且可以用作通用数据库, 同时它们可以横向扩展以适应大量数据。
`MongoDB` 是目前最受欢迎的文档数据库之一。

虽然大多数关系型数据库都增加了对`JSON`的支持, 但是简单的添加`JSON`数据类型并不能带来原生文档数据库的好处, 为什么？因为关系方法会降低开发人员的生产力, 处理关系方法成为开发人员必须处理的事情。

文档数据库相对使用`JSON`支持的关系型数据库有以下特点

- 专有扩展

处理文档意味着使用自定义的、特定于供应商的`SQL`函数，大多数开发人员都不熟悉这些函数，并且不能与您最喜欢的`SQL`工具一起使用。添加低级
`JDBC/ODBC`, `驱动程序`和`ORM`，您将面临复杂的开发过程，从而导致生产力低下。

- 原始数据处理

传统关系型数据库将`JSON`数据呈现为简单的字符串和数字, 这使得计算、比较和排序数据变得复杂且容易出错。
而`MongoDB`等原生文档数据库支持的丰富数据类型, 您可以按应用程序需要的任何方式构建数据——丰富的对象、键值对、表、地理空间和时间序列数据以及图像的节点和边。

- 数据质量

关系数据库几乎不提供验证文档模式的功能，因此您无法对`JSON`数据应用质量控制。而且您仍然需要为您的常规表格数据定义一个模式，随着您的应用程序功能的发展，当您需要更改您的表格时，所有开销都会随之而来。

- 高性能

大多数关系数据库不维护`JSON`数据的统计信息，从而阻止查询规划器优化针对文档的查询。

## 键值数据库

键值数据库(又称键值存储), 将值(可以是从数字或简单字符串到复杂对象的任何内容)与用于跟踪对象的键关联。
在最简单的形式中，键值存储类似于字典/数组/映射对象，因为它存在于大多数编程范式中，同时它是以持久的方式存储并由数据库管理系统(DBMS)管理。

键值数据库使用紧凑、高效的索引结构，能够快速、可靠地根据键定位值，这使它们成为需要能够在固定时间内查找和检索数据的系统的理想选择。
例如, `Redis`作为一个键值数据库, 它被优化用于跟踪持久数据库中相对简单的数据结构(原始类型、列表、堆和映射)。通过只支持有限的值类型, `Redis`能够提供一个非常简单的接口来查询和操作它们, 并在优化配置时能够获得极高的吞吐量。

键值型数据库是一种较简单的数据库，其中每个项目都包含键和值。
通常只能通过引用键来检索值，因此学习如何查询特定键值对通常很简单。
键值数据库非常适合需要存储大量数据但无需执行复杂查询来检索数据的使用案例。
常见的使用案例包括存储用户首选项或缓存。`Redis`和`DynanoDB`是流行的键值数据库。

## 宽列存储

宽列存储将数据存储在表、行和动态列中。
宽列存储提供了比关系型数据库更大的灵活性，因为不需要每一行都具有相同的列。
许多人认为宽列存储是二维键值数据库。
宽列存储非常适合需要存储大量数据并且可以预测查询模式的情况。
宽列存储通常用于存储物联网数据和用户配置文件数据。
`Cassandra`和`HBase`是较受欢迎的两种宽列存储。

## 图形数据库

图形数据库将数据存储在节点和边中。
节点通常存储有关人物、地点和事物的信息，而边缘则存储有关节点之间的关系的信息。
在需要遍历关系以查找模式（例如社交网络，欺诈检测和推荐引擎）的使用案例中，图形数据库非常出色。
`Neo4j`和`JanusGraph`是图形数据库的示例。


## 什么时候选用Redis, Memcached?

1. Redis功能强大（pepline, 消息队列，lua），支持5中类型 。Memcached 仅支持简单的KV类型
1. Redis提供数据持久化RDB和AOF， Memcached 不支持数据持久化
1. Redis适合数据存储，Memcached 适合缓存
1. io角度，redis提供多路复用（命令是单线程），Memcached 非阻塞，io多路复用，多线程
1. Redis提供了官方的Cluster, Memcached需要自主实现，部署复杂
